(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[0],{37:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},77:function(e,t,n){e.exports=function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){(function(t){e.exports=t.Phoenix=n(2)}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(a=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.r(t),n.d(t,"Channel",(function(){return N})),n.d(t,"Serializer",(function(){return A})),n.d(t,"Socket",(function(){return P})),n.d(t,"LongPoll",(function(){return _})),n.d(t,"Ajax",(function(){return I})),n.d(t,"Presence",(function(){return M}));var s="undefined"!=typeof self?self:null,l="undefined"!=typeof window?window:null,u=s||l||void 0,h="2.0.0",f=0,d=1,m=2,v=3,p="closed",g="errored",b="joined",E="joining",y="leaving",k="phx_close",j="phx_error",w="phx_join",O="phx_reply",C="phx_leave",S=[k,j,w,O,C],x="longpoll",T="websocket",R=function(e){return"function"==typeof e?e:function(){return e}},L=function(){function e(t,n,a,r){o(this,e),this.channel=t,this.event=n,this.payload=a||function(){return{}},this.receivedResp=null,this.timeout=r,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}return c(e,[{key:"resend",value:function(e){this.timeout=e,this.reset(),this.send()}},{key:"send",value:function(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}},{key:"receive",value:function(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}},{key:"reset",value:function(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}},{key:"matchReceive",value:function(e){var t=e.status,n=e.response;e.ref,this.recHooks.filter((function(e){return e.status===t})).forEach((function(e){return e.callback(n)}))}},{key:"cancelRefEvent",value:function(){this.refEvent&&this.channel.off(this.refEvent)}},{key:"cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}},{key:"startTimeout",value:function(){var e=this;this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,(function(t){e.cancelRefEvent(),e.cancelTimeout(),e.receivedResp=t,e.matchReceive(t)})),this.timeoutTimer=setTimeout((function(){e.trigger("timeout",{})}),this.timeout)}},{key:"hasReceived",value:function(e){return this.receivedResp&&this.receivedResp.status===e}},{key:"trigger",value:function(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}}]),e}(),N=function(){function e(t,n,a){var r=this;o(this,e),this.state=p,this.topic=t,this.params=R(n||{}),this.socket=a,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new L(this,w,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new H((function(){r.socket.isConnected()&&r.rejoin()}),this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError((function(){return r.rejoinTimer.reset()}))),this.stateChangeRefs.push(this.socket.onOpen((function(){r.rejoinTimer.reset(),r.isErrored()&&r.rejoin()}))),this.joinPush.receive("ok",(function(){r.state=b,r.rejoinTimer.reset(),r.pushBuffer.forEach((function(e){return e.send()})),r.pushBuffer=[]})),this.joinPush.receive("error",(function(){r.state=g,r.socket.isConnected()&&r.rejoinTimer.scheduleTimeout()})),this.onClose((function(){r.rejoinTimer.reset(),r.socket.hasLogger()&&r.socket.log("channel","close ".concat(r.topic," ").concat(r.joinRef())),r.state=p,r.socket.remove(r)})),this.onError((function(e){r.socket.hasLogger()&&r.socket.log("channel","error ".concat(r.topic),e),r.isJoining()&&r.joinPush.reset(),r.state=g,r.socket.isConnected()&&r.rejoinTimer.scheduleTimeout()})),this.joinPush.receive("timeout",(function(){r.socket.hasLogger()&&r.socket.log("channel","timeout ".concat(r.topic," (").concat(r.joinRef(),")"),r.joinPush.timeout),new L(r,C,R({}),r.timeout).send(),r.state=g,r.joinPush.reset(),r.socket.isConnected()&&r.rejoinTimer.scheduleTimeout()})),this.on(O,(function(e,t){r.trigger(r.replyEventName(t),e)}))}return c(e,[{key:"join",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}},{key:"onClose",value:function(e){this.on(k,e)}},{key:"onError",value:function(e){return this.on(j,(function(t){return e(t)}))}},{key:"on",value:function(e,t){var n=this.bindingRef++;return this.bindings.push({event:e,ref:n,callback:t}),n}},{key:"off",value:function(e,t){this.bindings=this.bindings.filter((function(n){return!(n.event===e&&(void 0===t||t===n.ref))}))}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.isJoined()}},{key:"push",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw new Error("tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.join() before pushing events"));var a=new L(this,e,(function(){return t}),n);return this.canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}},{key:"leave",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=y;var n=function(){e.socket.hasLogger()&&e.socket.log("channel","leave ".concat(e.topic)),e.trigger(k,"leave")},a=new L(this,C,R({}),t);return a.receive("ok",(function(){return n()})).receive("timeout",(function(){return n()})),a.send(),this.canPush()||a.trigger("ok",{}),a}},{key:"onMessage",value:function(e,t,n){return t}},{key:"isLifecycleEvent",value:function(e){return S.indexOf(e)>=0}},{key:"isMember",value:function(e,t,n,a){return this.topic===e&&(!a||a===this.joinRef()||!this.isLifecycleEvent(t)||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:n,joinRef:a}),!1))}},{key:"joinRef",value:function(){return this.joinPush.ref}},{key:"sendJoin",value:function(e){this.state=E,this.joinPush.resend(e)}},{key:"rejoin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.isLeaving()||this.sendJoin(e)}},{key:"trigger",value:function(e,t,n,a){var r=this.onMessage(e,t,n,a);if(t&&!r)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(var o=0;o<this.bindings.length;o++){var i=this.bindings[o];i.event===e&&i.callback(r,n,a||this.joinRef())}}},{key:"replyEventName",value:function(e){return"chan_reply_".concat(e)}},{key:"isClosed",value:function(){return this.state===p}},{key:"isErrored",value:function(){return this.state===g}},{key:"isJoined",value:function(){return this.state===b}},{key:"isJoining",value:function(){return this.state===E}},{key:"isLeaving",value:function(){return this.state===y}}]),e}(),A={encode:function(e,t){var n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))},decode:function(e,t){var n=r(JSON.parse(e),5);return t({join_ref:n[0],ref:n[1],topic:n[2],event:n[3],payload:n[4]})}},P=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=a.timeout||1e4,this.transport=a.transport||u.WebSocket||_,this.defaultEncoder=A.encode,this.defaultDecoder=A.decode,this.closeWasClean=!1,this.unloaded=!1,this.binaryType=a.binaryType||"arraybuffer",this.transport!==_?(this.encode=a.encode||this.defaultEncoder,this.decode=a.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),l&&l.addEventListener&&l.addEventListener("unload",(function(e){n.conn&&(n.unloaded=!0,n.abnormalClose("unloaded"))})),this.heartbeatIntervalMs=a.heartbeatIntervalMs||3e4,this.rejoinAfterMs=function(e){return a.rejoinAfterMs?a.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4},this.reconnectAfterMs=function(e){return n.unloaded?100:a.reconnectAfterMs?a.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3},this.logger=a.logger||null,this.longpollerTimeout=a.longpollerTimeout||2e4,this.params=R(a.params||{}),this.endPoint="".concat(t,"/").concat(T),this.vsn=a.vsn||h,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new H((function(){n.teardown((function(){return n.connect()}))}),this.reconnectAfterMs)}return c(e,[{key:"protocol",value:function(){return location.protocol.match(/^https/)?"wss":"ws"}},{key:"endPointURL",value:function(){var e=I.appendParams(I.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?"".concat(this.protocol(),":").concat(e):"".concat(this.protocol(),"://").concat(location.host).concat(e)}},{key:"disconnect",value:function(e,t,n){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,n)}},{key:"connect",value:function(e){var t=this;e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=R(e)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=function(){return t.onConnOpen()},this.conn.onerror=function(e){return t.onConnError(e)},this.conn.onmessage=function(e){return t.onConnMessage(e)},this.conn.onclose=function(e){return t.onConnClose(e)})}},{key:"log",value:function(e,t,n){this.logger(e,t,n)}},{key:"hasLogger",value:function(){return null!==this.logger}},{key:"onOpen",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}},{key:"onClose",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}},{key:"onError",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}},{key:"onMessage",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}},{key:"onConnOpen",value:function(){this.hasLogger()&&this.log("transport","connected to ".concat(this.endPointURL())),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach((function(e){return(0,r(e,2)[1])()}))}},{key:"resetHeartbeat",value:function(){var e=this;this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((function(){return e.sendHeartbeat()}),this.heartbeatIntervalMs))}},{key:"teardown",value:function(e,t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n||""):this.conn.close(),this.conn=null),e&&e()}},{key:"onConnClose",value:function(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((function(t){return(0,r(t,2)[1])(e)}))}},{key:"onConnError",value:function(e){this.hasLogger()&&this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach((function(t){return(0,r(t,2)[1])(e)}))}},{key:"triggerChanError",value:function(){this.channels.forEach((function(e){e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(j)}))}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case f:return"connecting";case d:return"open";case m:return"closing";default:return"closed"}}},{key:"isConnected",value:function(){return"open"===this.connectionState()}},{key:"remove",value:function(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter((function(t){return t.joinRef()!==e.joinRef()}))}},{key:"off",value:function(e){for(var t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter((function(t){var n=r(t,1)[0];return!e.includes(n)}))}},{key:"channel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new N(e,t,this);return this.channels.push(n),n}},{key:"push",value:function(e){var t=this;if(this.hasLogger()){var n=e.topic,a=e.event,r=e.payload,o=e.ref,i=e.join_ref;this.log("push","".concat(n," ").concat(a," (").concat(i,", ").concat(o,")"),r)}this.isConnected()?this.encode(e,(function(e){return t.conn.send(e)})):this.sendBuffer.push((function(){return t.encode(e,(function(e){return t.conn.send(e)}))}))}},{key:"makeRef",value:function(){var e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}},{key:"sendHeartbeat",value:function(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.abnormalClose("heartbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}},{key:"abnormalClose",value:function(e){this.closeWasClean=!1,this.conn.close(1e3,e)}},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((function(e){return e()})),this.sendBuffer=[])}},{key:"onConnMessage",value:function(e){var t=this;this.decode(e.data,(function(e){var n=e.topic,a=e.event,o=e.payload,i=e.ref,c=e.join_ref;i&&i===t.pendingHeartbeatRef&&(t.pendingHeartbeatRef=null),t.hasLogger()&&t.log("receive","".concat(o.status||""," ").concat(n," ").concat(a," ").concat(i&&"("+i+")"||""),o);for(var s=0;s<t.channels.length;s++){var l=t.channels[s];l.isMember(n,a,o,c)&&l.trigger(a,o,i,c)}for(var u=0;u<t.stateChangeCallbacks.message.length;u++)(0,r(t.stateChangeCallbacks.message[u],2)[1])(e)}))}}]),e}(),_=function(){function e(t){o(this,e),this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(t),this.readyState=f,this.poll()}return c(e,[{key:"normalizeEndpoint",value:function(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+T),"$1/"+x)}},{key:"endpointURL",value:function(){return I.appendParams(this.pollEndpoint,{token:this.token})}},{key:"closeAndRetry",value:function(){this.close(),this.readyState=f}},{key:"ontimeout",value:function(){this.onerror("timeout"),this.closeAndRetry()}},{key:"poll",value:function(){var e=this;this.readyState!==d&&this.readyState!==f||I.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),(function(t){if(t){var n=t.status,a=t.token,r=t.messages;e.token=a}else n=0;switch(n){case 200:r.forEach((function(t){return e.onmessage({data:t})})),e.poll();break;case 204:e.poll();break;case 410:e.readyState=d,e.onopen(),e.poll();break;case 0:case 500:e.onerror(),e.closeAndRetry();break;default:throw new Error("unhandled poll status ".concat(n))}}))}},{key:"send",value:function(e){var t=this;I.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),(function(e){e&&200===e.status||(t.onerror(e&&e.status),t.closeAndRetry())}))}},{key:"close",value:function(e,t){this.readyState=v,this.onclose()}}]),e}(),I=function(){function e(){o(this,e)}return c(e,null,[{key:"request",value:function(e,t,n,a,r,o,i){if(u.XDomainRequest){var c=new XDomainRequest;this.xdomainRequest(c,e,t,a,r,o,i)}else{var s=u.XMLHttpRequest?new u.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(s,e,t,n,a,r,o,i)}}},{key:"xdomainRequest",value:function(e,t,n,a,r,o,i){var c=this;e.timeout=r,e.open(t,n),e.onload=function(){var t=c.parseJSON(e.responseText);i&&i(t)},o&&(e.ontimeout=o),e.onprogress=function(){},e.send(a)}},{key:"xhrRequest",value:function(e,t,n,a,r,o,i,c){var s=this;e.open(t,n,!0),e.timeout=o,e.setRequestHeader("Content-Type",a),e.onerror=function(){c&&c(null)},e.onreadystatechange=function(){if(e.readyState===s.states.complete&&c){var t=s.parseJSON(e.responseText);c(t)}},i&&(e.ontimeout=i),e.send(r)}},{key:"parseJSON",value:function(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}},{key:"serialize",value:function(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=t?"".concat(t,"[").concat(r,"]"):r,i=e[r];"object"===a(i)?n.push(this.serialize(i,o)):n.push(encodeURIComponent(o)+"="+encodeURIComponent(i))}return n.join("&")}},{key:"appendParams",value:function(e,t){if(0===Object.keys(t).length)return e;var n=e.match(/\?/)?"&":"?";return"".concat(e).concat(n).concat(this.serialize(t))}}]),e}();I.states={complete:4};var M=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e);var r=a.events||{state:"presence_state",diff:"presence_diff"};this.state={},this.pendingDiffs=[],this.channel=t,this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}},this.channel.on(r.state,(function(t){var a=n.caller,r=a.onJoin,o=a.onLeave,i=a.onSync;n.joinRef=n.channel.joinRef(),n.state=e.syncState(n.state,t,r,o),n.pendingDiffs.forEach((function(t){n.state=e.syncDiff(n.state,t,r,o)})),n.pendingDiffs=[],i()})),this.channel.on(r.diff,(function(t){var a=n.caller,r=a.onJoin,o=a.onLeave,i=a.onSync;n.inPendingSyncState()?n.pendingDiffs.push(t):(n.state=e.syncDiff(n.state,t,r,o),i())}))}return c(e,[{key:"onJoin",value:function(e){this.caller.onJoin=e}},{key:"onLeave",value:function(e){this.caller.onLeave=e}},{key:"onSync",value:function(e){this.caller.onSync=e}},{key:"list",value:function(t){return e.list(this.state,t)}},{key:"inPendingSyncState",value:function(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}],[{key:"syncState",value:function(e,t,n,a){var r=this,o=this.clone(e),i={},c={};return this.map(o,(function(e,n){t[e]||(c[e]=n)})),this.map(t,(function(e,t){var n=o[e];if(n){var a=t.metas.map((function(e){return e.phx_ref})),s=n.metas.map((function(e){return e.phx_ref})),l=t.metas.filter((function(e){return s.indexOf(e.phx_ref)<0})),u=n.metas.filter((function(e){return a.indexOf(e.phx_ref)<0}));l.length>0&&(i[e]=t,i[e].metas=l),u.length>0&&(c[e]=r.clone(n),c[e].metas=u)}else i[e]=t})),this.syncDiff(o,{joins:i,leaves:c},n,a)}},{key:"syncDiff",value:function(e,t,n,a){var r=t.joins,o=t.leaves,i=this.clone(e);return n||(n=function(){}),a||(a=function(){}),this.map(r,(function(e,t){var a=i[e];if(i[e]=t,a){var r,o=i[e].metas.map((function(e){return e.phx_ref})),c=a.metas.filter((function(e){return o.indexOf(e.phx_ref)<0}));(r=i[e].metas).unshift.apply(r,function(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(c))}n(e,a,t)})),this.map(o,(function(e,t){var n=i[e];if(n){var r=t.metas.map((function(e){return e.phx_ref}));n.metas=n.metas.filter((function(e){return r.indexOf(e.phx_ref)<0})),a(e,n,t),0===n.metas.length&&delete i[e]}})),i}},{key:"list",value:function(e,t){return t||(t=function(e,t){return t}),this.map(e,(function(e,n){return t(e,n)}))}},{key:"map",value:function(e,t){return Object.getOwnPropertyNames(e).map((function(n){return t(n,e[n])}))}},{key:"clone",value:function(e){return JSON.parse(JSON.stringify(e))}}]),e}(),H=function(){function e(t,n){o(this,e),this.callback=t,this.timerCalc=n,this.timer=null,this.tries=0}return c(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}()}])},81:function(e,t,n){e.exports=n(96)},82:function(e,t,n){"use strict";!function(){var e=function(){if("function"===typeof window.CustomEvent)return window.CustomEvent;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return e.prototype=window.Event.prototype,e}();function t(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function n(e){var n=e.getAttribute("data-to"),a=t("_method",e.getAttribute("data-method")),r=t("_csrf_token",e.getAttribute("data-csrf")),o=document.createElement("form"),i=e.getAttribute("target");o.method="get"===e.getAttribute("data-method")?"get":"post",o.action=n,o.style.display="hidden",i&&(o.target=i),o.appendChild(r),o.appendChild(a),document.body.appendChild(o),o.submit()}window.addEventListener("click",(function(t){for(var a=t.target;a&&a.getAttribute;){var r=new e("phoenix.link.click",{bubbles:!0,cancelable:!0});if(!a.dispatchEvent(r))return t.preventDefault(),t.stopImmediatePropagation(),!1;if(a.getAttribute("data-method"))return n(a),t.preventDefault(),!1;a=a.parentNode}}),!1),window.addEventListener("phoenix.link.click",(function(e){var t=e.target.getAttribute("data-confirm");t&&!window.confirm(t)&&e.preventDefault()}),!1)}()},92:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);n(82);var a=n(0),r=n.n(a),o=n(26),i=n.n(o),c=n(6),s=n(45),l=n(30),u=n(61),h=n(7),f=n(60),d=n(22);function m(e){if(void 0!==e)return JSON.parse(JSON.stringify(e))}function v(e,t){return 0==t?e:t>e.length?[]:e.filter((function(e,n,a){return n>=t}))}function p(e){window.location.href=e,window.location.reload()}function g(){var e,t=null===(e=window)||void 0===e?void 0:e.userToken;return void 0!==t?t:""}var b=function(e,t){var n;switch(t.type){case"LOAD_USER":return{state:{user:m(t.payload)}};case"LOAD_CHARACTER":return{state:{user:m(null===e||void 0===e||null===(n=e.state)||void 0===n?void 0:n.user),character:m(t.payload)}};case"CLEAR_STATE":return{};default:return e||{}}},E=function(){var e=sessionStorage.getItem("user-state");if(void 0===e||""===e)return Object(f.b)(b);var t=JSON.parse(e);return Object(f.b)(b,t,Object(f.a)(y))}();function y(e){var t=e.getState;return function(e){return function(n){var a,r=e(n),o=t(),i=b(o,r);return"CLEAR_STATE"===n.type?k():(a=i,k(),sessionStorage.setItem("user-state",JSON.stringify(a))),r}}}function k(){sessionStorage.clear()}var j={type:"CLEAR_STATE"};function w(e,t){e.dispatch(function(e){return{type:"LOAD_CHARACTER",payload:e}}(t))}function O(e){e.dispatch(j)}var C={errors:["No response"]};function S(e){return void 0!==e&&(void 0===e.errors||0===e.errors.length)}function x(e,t){return"".concat(t,":\r\n").concat(e.errors.join("\r\n"))}function T(e){return"".concat(window.location.origin,"/").concat(e)}function R(e){var t=T(e);return fetch(t,{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(e){return e}))}function L(e,t){var n=T(e);return fetch(n,{method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){return e}))}function N(e){return R("/api/characters/list/".concat(e))}function A(e){return R("/api/characters/".concat(e))}function P(e){var t=Object(a.useState)([]),n=Object(c.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)(""),l=Object(c.a)(s,2),u=l[0],f=l[1],d=function(){var e;void 0===(null===(e=E.getState().state)||void 0===e?void 0:e.character)&&void 0!==o&&o.length>0&&w(E,o[0])};Object(a.useEffect)((function(){f(m()),function(){var e,t;void 0!==(null===(e=E.getState().state)||void 0===e?void 0:e.user)&&N(null===(t=E.getState().state)||void 0===t?void 0:t.user.id).then((function(e){S(e)?(i(e),d()):(O(E),window.location.href="/login/unauthorized",window.location.reload())}))}()}),[]);var m=function(){var e,t=null===(e=E.getState().state)||void 0===e?void 0:e.character;return void 0!==t?t.id:void 0!==o&&o.length>0?o[0].id:""};return r.a.createElement(h.a.Control,{as:"select",onChange:function(e){var t=e.target.value,n=o.filter((function(e){return"".concat(e.id)===t}));w(E,n[0]),f(m())},value:u,className:"bg-dark text-white"},void 0!==o?o.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})):r.a.createElement("option",null))}n(37);function _(e){var t=function(){var e=document.getElementById("navbar-toggle-button");(null===e||void 0===e?void 0:e.classList.contains("collapsed"))||null===e||void 0===e||e.click()};return r.a.createElement(s.a,{className:"navbar navbar-expand-lg navbar-dark menu",bg:"dark",variant:"dark",expand:"lg"},r.a.createElement(s.a.Brand,{href:"#/",onClick:t},r.a.createElement("img",{alt:"",src:"/images/logo-30x30.png",width:"30",height:"30",className:"d-inline-block align-top"})),r.a.createElement(s.a.Toggle,{"aria-controls":"basic-navbar-nav",id:"navbar-toggle-button"}),r.a.createElement(s.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(l.a,{className:"mr-auto"},r.a.createElement(l.a.Link,{href:"#/users",onClick:t},"List"),r.a.createElement(u.a,{title:"Character",id:"basic-nav-dropdown"},r.a.createElement(u.a.Item,{href:"#/characters",onClick:t},"List"),r.a.createElement(u.a.Item,{href:"#/character/new",onClick:t},"New")),r.a.createElement(l.a.Link,{href:"#/chats",onClick:t},"Map")),e.logged?r.a.createElement(l.a,null,r.a.createElement(P,{history:e.history}),r.a.createElement(l.a.Link,{href:"#/logout",onClick:t},"Logout")):r.a.createElement(l.a,null,r.a.createElement(l.a.Link,{href:"#/login",onClick:t},"Login"),r.a.createElement(l.a.Link,{href:"#/registration",onClick:t},"Registration"))))}var I=n(35),M=n(8);function H(){return r.a.createElement("div",{className:"app-container"},"Bienvenue dans le app. Token: ",g())}var J=n(15),D=n(74);function B(e){return r.a.createElement("div",null,e.isWaiting?r.a.createElement(J.a,{variant:"dark",disabled:!0},r.a.createElement(D.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}),"Loading..."):r.a.createElement(J.a,{variant:"dark",type:"submit"},e.buttonText))}var U=n(19);function W(e){var t=function(){e.onOk()};return r.a.createElement(U.a,{show:e.show,onHide:t},r.a.createElement(U.a.Header,{closeButton:!0},r.a.createElement(U.a.Title,null,"Info")),r.a.createElement(U.a.Body,null,e.text),r.a.createElement(U.a.Footer,null,r.a.createElement(J.a,{variant:"primary",onClick:t},e.buttonText)))}n(92);function z(e){return e.errors.length>0&&e.errors.filter((function(e){return"User not logged"===e||"User unauthorized"===e})).length>0}function G(e){var t=Object(a.useState)(""),n=Object(c.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)(""),l=Object(c.a)(s,2),u=l[0],f=l[1],m=Object(a.useState)(!1),v=Object(c.a)(m,2),g=v[0],b=v[1],y=Object(a.useState)(""),k=Object(c.a)(y,2),j=k[0],w=k[1],x=Object(a.useState)(!1),T=Object(c.a)(x,2),R=T[0],N=T[1];Object(a.useEffect)((function(){e.isUnauthorized&&(w("Login expired, please log on again."),N(!0))}),[]);return r.a.createElement("div",{className:"users-form-container"},r.a.createElement(W,{text:j,show:R,buttonText:"Ok",onOk:function(){return N(!1)}}),r.a.createElement(h.a,{onSubmit:function(t){var n;t.preventDefault(),b(!0),(n={username:o,password:u},L("/api/login",n)).then((function(t){if(b(!1),S(t))e.onLogged(t),p("#/");else{O(E);var n=function(e){return void 0===e||void 0===e.errors||0===e.errors.length?C:e}(t);console.error("Error while performing login!",n),w(function(e){if(1===e.errors.length)return e.errors[0];var t,n="There were errors while performing login",a=Object(d.a)(e.errors);try{for(a.s();!(t=a.n()).done;){var r=t.value;n="".concat(n,"\r\n").concat(r)}}catch(r){a.e(r)}finally{a.f()}return n}(n)),N(!0)}})).catch((function(e){b(!1),O(E),console.error(e)}))}},r.a.createElement(h.a.Group,{controlId:"email"},r.a.createElement(h.a.Label,null,"Email address"),r.a.createElement(h.a.Control,{type:"email",className:"bg-dark text-light",placeholder:"Enter email",onChange:function(e){return i(e.target.value)}})),r.a.createElement(h.a.Group,{controlId:"password"},r.a.createElement(h.a.Label,null,"Password"),r.a.createElement(h.a.Control,{type:"password",className:"bg-dark text-light",placeholder:"Password",onChange:function(e){return f(e.target.value)}})),r.a.createElement("div",{className:"users-form-submit-button"},r.a.createElement(B,{buttonText:"Login",isWaiting:g}))))}function q(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),s=Object(c.a)(i,2),l=s[0],u=s[1],f=Object(a.useState)(""),d=Object(c.a)(f,2),m=d[0],v=d[1],p=Object(a.useState)(!1),g=Object(c.a)(p,2),b=g[0],E=g[1],y=Object(a.useState)(""),k=Object(c.a)(y,2),j=k[0],w=k[1],O=Object(M.f)();return r.a.createElement("div",{className:"users-form-container"},r.a.createElement(W,{text:j,show:b,buttonText:"Ok",onOk:function(){E(!1),O.push("/")}}),r.a.createElement(h.a,{onSubmit:function(e){var t;(t={email:n,username:l,form_password:m},L("/api/users",{user:t})).then((function(e){S(e)&&void 0!==e.id?w("Character created, you will be redirected."):w("Error while creating the character. Please contact support."),E(!0)}))}},r.a.createElement(h.a.Group,{controlId:"email"},r.a.createElement(h.a.Label,null,"Email address"),r.a.createElement(h.a.Control,{type:"email",onChange:function(e){var t=e.target.value;o(t)},className:"bg-dark text-light",placeholder:"Enter email"}),r.a.createElement(h.a.Text,{className:"text-muted"},"The registration e-mail will be received at this recipient.")),r.a.createElement(h.a.Group,{controlId:"username"},r.a.createElement(h.a.Label,null,"Username"),r.a.createElement(h.a.Control,{type:"text",onChange:function(e){var t=e.target.value;u(t)},className:"bg-dark text-light",placeholder:"Enter username"})),r.a.createElement(h.a.Group,{controlId:"password"},r.a.createElement(h.a.Label,null,"Password"),r.a.createElement(h.a.Control,{type:"password",onChange:function(e){var t=e.target.value;v(t)},className:"bg-dark text-light",placeholder:"Password"})),r.a.createElement("div",{className:"users-form-submit-button"},r.a.createElement(J.a,{variant:"dark",type:"submit"},"Login"))))}var X=n(79),F=n(76);n(95);function $(e){var t=Object(a.useState)(!1),n=Object(c.a)(t,2),o=(n[0],n[1],Object(a.useState)("")),i=Object(c.a)(o,2),s=i[0],l=i[1],u=Object(a.useCallback)((function(t){t.forEach((function(t){if(console.log("Reading file ".concat(t.name)),"png"===function(e){if(0!==e.length)return e[e.length-1]}(t.name.split("."))){var n=document.getElementById("file-check"),a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var t=a.result;if(t.byteLength>1e6)void 0!==e.onError&&e.onError("Image too big!");else{var r=function(e){var t=new Uint8Array(e),n="",a=function(e){return e.reduce((function(e,t){return e+String.fromCharCode(t)}),"")};if(e.byteLength<=1e3)try{n=String.fromCharCode.apply(null,t)}catch(r){console.log("doing it with reduce after exception"),n=a(t)}else console.log("doing it with reduce"),n=a(t);return window.btoa(n)}(t);e.onLoad(r),e.showPreview&&l(r),n.checked=!0}},a.readAsArrayBuffer(t)}else void 0!==e.onError&&e.onError("Wrong file extension")}))}),[]),f=function(t){return r.a.createElement(F.a,null,r.a.createElement("h3",null,e.title),r.a.createElement("div",null,t))},d=Object(X.a)({onDrop:u}),m=d.getRootProps,v=d.getInputProps,p=d.isDragActive;return r.a.createElement("div",null,r.a.createElement("div",{className:"file-drop-container"},r.a.createElement("div",{className:"file-name-control"},r.a.createElement("div",m(),r.a.createElement("input",v()),f(p?"Release to upload.":"Drag the file here (only PNG allowed...")),r.a.createElement(h.a.Group,null,r.a.createElement(h.a.Check,{required:!0,disabled:!0,id:"file-check",label:"File uploaded!",feedback:"Please drop a file."})))),e.showPreview&&void 0!==s&&""!==s?r.a.createElement("div",{className:"avatar-preview-container"},r.a.createElement("img",{src:"data:image/png;base64,".concat(s),className:"avatar-preview-image",alt:"avatar"})):r.a.createElement("div",null))}var K=n(66);function Q(e){var t,n=function(){void 0!==t&&clearTimeout(t),e.onClose()};Object(a.useEffect)((function(){e.show&&(t=setTimeout(n,5e3))}),[]);return e.show?r.a.createElement(K.a,{variant:"dark",onClose:n,dismissible:!0},r.a.createElement(K.a.Heading,null,"Error!"),r.a.createElement("p",null,e.message)):r.a.createElement("div",null)}function V(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),s=Object(c.a)(i,2),l=s[0],u=s[1],f=Object(a.useState)(""),d=Object(c.a)(f,2),m=d[0],v=d[1],p=Object(a.useState)(""),g=Object(c.a)(p,2),b=g[0],y=g[1],k=Object(a.useState)(!1),j=Object(c.a)(k,2),w=j[0],O=j[1],C=Object(a.useState)(""),T=Object(c.a)(C,2),R=T[0],N=T[1],A=Object(a.useState)(!1),P=Object(c.a)(A,2),_=P[0],I=P[1],H=Object(a.useState)(!1),J=Object(c.a)(H,2),D=J[0],U=J[1],z=Object(M.f)(),G=function(e){console.error("Shoring error!",e),N(e),I(!0)};return r.a.createElement("div",{className:"app-container"},r.a.createElement(Q,{message:R,show:_,onClose:function(){console.log("closing..."),I(!1)}}),r.a.createElement(W,{text:"Character created, you will now be redirected.",show:D,buttonText:"Ok",onOk:function(){U(!1),z.push("/"),document.location.reload()}}),r.a.createElement(h.a,{onSubmit:function(e){var t,a;e.preventDefault(),O(!0),(a={user_id:null===(t=E.getState().state)||void 0===t?void 0:t.user.id,name:n,description:l,notes:m,avatar:b},L("/api/characters",{character:a})).then((function(e){S(e)||G(x(e,"Error while creating character!")),O(!1),U(!0)}))}},r.a.createElement(h.a.Group,{controlId:"name"},r.a.createElement(h.a.Label,null,"Name"),r.a.createElement(h.a.Control,{type:"text",onChange:function(e){var t=e.target.value;o(t)},className:"bg-dark text-light",placeholder:"Name"})),r.a.createElement(h.a.Group,{controlId:"description"},r.a.createElement(h.a.Label,null,"Description"),r.a.createElement(h.a.Control,{type:"textarea",onChange:function(e){var t=e.target.value;u(t)},className:"bg-dark text-light",placeholder:"Description"})),r.a.createElement(h.a.Group,{controlId:"notes"},r.a.createElement(h.a.Label,null,"Notes"),r.a.createElement(h.a.Control,{type:"textarea",onChange:function(e){var t=e.target.value;v(t)},className:"bg-dark text-light",placeholder:"Notes"})),r.a.createElement("div",{className:"avatar-container"},r.a.createElement($,{title:"Avatar upload",showPreview:!0,onLoad:y,onError:G})),r.a.createElement(B,{buttonText:"Submit",isWaiting:w})))}var Y=n(80),Z=n(77),ee=n(33),te=n(29),ne=n(13);n(70);function ae(e){var t=Object(a.useState)(""),n=Object(c.a)(t,2),o=n[0],i=n[1];return r.a.createElement(h.a,{className:e.className,onSubmit:function(t){t.preventDefault();var n=document.getElementById("submit-text");void 0!==n&&(n.value=""),e.onSubmit(o)}},r.a.createElement(ee.a,null,r.a.createElement(te.a,null,r.a.createElement(ne.a,{xs:"9",md:"10"},r.a.createElement(h.a.Group,{controlId:"submit-text"},r.a.createElement(h.a.Control,{type:"text",onChange:function(e){i(e.target.value)},className:"bg-dark text-white",placeholder:"Enter action text here"}))),r.a.createElement(ne.a,{xs:"3",md:"2"},r.a.createElement(J.a,{variant:"dark",type:"submit"},"Submit")))))}n(71);function re(e){var t,n,a;return r.a.createElement(U.a,{show:e.show,size:"lg","aria-labelledby":"contained-modal-title-vcenter",onHide:function(){return e.onClose()},centered:!0},r.a.createElement(U.a.Header,{closeButton:!0},r.a.createElement(U.a.Title,{id:"contained-modal-title-vcenter"},null===(t=e.character)||void 0===t?void 0:t.name)),r.a.createElement(U.a.Body,null,r.a.createElement(ee.a,null,r.a.createElement(te.a,null,r.a.createElement(ne.a,{xs:12,md:4},r.a.createElement("img",{src:"data:image/png;base64,".concat(null===(n=e.character)||void 0===n?void 0:n.avatar),className:"sheet-avatar-image",alt:"avatar"})),r.a.createElement(ne.a,{xs:12,md:8},null===(a=e.character)||void 0===a?void 0:a.description)))),r.a.createElement(U.a.Footer,null,r.a.createElement(J.a,{className:"bg-dark",onClick:e.onClose},"Close")))}function oe(){var e=Object(M.g)().id,t=Object(a.useState)(),n=Object(c.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)({}),l=Object(c.a)(s,2),u=l[0],h=l[1],f=Object(a.useState)(),d=Object(c.a)(f,2),m=d[0],v=d[1],p=Object(a.useState)(!1),b=Object(c.a)(p,2),y=b[0],k=b[1],j=new Z.Socket("/socket",{params:{token:g()},logger:function(e,t,n){console.log("".concat(e,": ").concat(t),n)}});Object(a.useEffect)((function(){(function(e){return R("/api/rooms/".concat(e))})(e).then((function(e){S(e)&&i(e)})),console.log("Connecting... "),j.connect();var t=j.channel("chats:".concat(e));t.on("new_chat_log",(function(e){console.log("pushing single chat",e),O(e)})),t.join().receive("ok",(function(e){var t=e.chats;console.log("Pushing chats"),O.apply(void 0,Object(Y.a)(t))})).receive("error",(function(e){return console.error("Error while joining the chat!",e)})),h({channel:t})}),[]);var w=function(e){var t=document.createElement("a");t.href="javascript:void(0);",t.onclick=function(){A(e.character_id).then((function(e){S(e)&&(v(e),k(!0))}))},t.innerHTML="<b>".concat(e.character_name,"</b>");var n=document.createElement("span");n.appendChild(t);var a=document.createElement("span");a.innerHTML="[".concat(e.date.split("T")[1],"] - ");var r=document.createElement("span");r.innerHTML="</a>: ".concat(e.text);var o=document.createElement("div");return o.className="chat-log",o.appendChild(a).appendChild(n).appendChild(r),o},O=function(){var e=document.getElementById("chat-show");if(void 0!==e&&null!==e){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(var r=0,o=n;r<o.length;r++){var i=o[r];e.appendChild(w(i))}e.scrollTop=e.scrollHeight}};return r.a.createElement("div",{id:"chat-screen"},r.a.createElement(re,{character:m,show:y,onClose:function(){return k(!1)}}),r.a.createElement("h3",{style:{padding:"3px"}},null===o||void 0===o?void 0:o.name),r.a.createElement("div",{id:"chat-show",className:"chat-show"}),r.a.createElement(ae,{className:"chat-input",onSubmit:function(t){var n,a;void 0!==u.channel?u.channel.push("new_chat_log_insert",{character_id:null===(n=E.getState().state)||void 0===n||null===(a=n.character)||void 0===a?void 0:a.id,chat_rooms_id:e,text:t}).receive("error",(function(e){return console.error("Error!",e)})):console.error("Channel undefined")}}))}function ie(e){return Object(a.useEffect)((function(){L("/api/logout",{}).then((function(t){e.onLogout(),p("#/")}))}),[]),r.a.createElement("div",null,"Logging out... ")}function ce(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1];Object(a.useEffect)((function(){R("/api/users").then((function(e){S(e)&&o(e)}))}),[]);return r.a.createElement("ul",null,function(){var e,t=[],a=Object(d.a)(n);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(r.a.createElement("li",{key:o.id},o.username))}}catch(i){a.e(i)}finally{a.f()}return t}())}function se(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(M.f)();Object(a.useEffect)((function(){var e,t=null===(e=E.getState().state)||void 0===e?void 0:e.user.id;void 0!==t?N(t).then((function(e){S(e)?o(e):alert("Error!: ".concat(JSON.stringify(e)))})):i.push("/login")}),[]);return r.a.createElement("div",{className:"app-container"},r.a.createElement("h3",null,"Characters"),r.a.createElement("ul",null,function(){var e,t=[],a=Object(d.a)(n);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(r.a.createElement("li",{key:o.id},r.a.createElement(I.b,{to:"character/".concat(o.id)},o.name)))}}catch(i){a.e(i)}finally{a.f()}return t}()))}function le(){var e,t,n,o=Object(M.g)().id,i=Object(M.f)(),s=Object(a.useState)({}),l=Object(c.a)(s,2),u=l[0],h=l[1],f=Object(a.useState)(""),d=Object(c.a)(f,2),m=d[0],v=d[1],p=Object(a.useState)(!1),g=Object(c.a)(p,2),b=g[0],E=g[1];Object(a.useEffect)((function(){A(o).then((function(e){S(e)?h({character:e}):(z(e)&&i.push("/login/unauthorized"),v(x(e,"Cannot load character sheet")),E(!0))}))}),[]);return r.a.createElement("div",{className:"app-container"},r.a.createElement(Q,{message:m,show:b,onClose:function(){E(!1)}}),r.a.createElement("h3",null,null===(e=u.character)||void 0===e?void 0:e.name),r.a.createElement("div",null,r.a.createElement(ee.a,null,r.a.createElement(te.a,null,r.a.createElement(ne.a,{xs:12,md:4},void 0!==u.character?r.a.createElement("div",{className:"sheet-avatar-container"},r.a.createElement("img",{src:"data:image/png;base64,".concat(u.character.avatar),className:"sheet-avatar-image",alt:"avatar"})):r.a.createElement("div",null)),r.a.createElement(ne.a,{xs:12,md:8},null===(t=u.character)||void 0===t?void 0:t.description)),r.a.createElement(te.a,null,r.a.createElement(ne.a,null,null===(n=u.character)||void 0===n?void 0:n.notes)))))}var ue=n(78);function he(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),s=Object(c.a)(i,2),l=s[0],u=s[1],h=Object(M.f)();Object(a.useEffect)((function(){R("/api/rooms").then((function(e){console.log("rooms",e),S(e)?o(e):z(e)&&h.push("/login/unauthorized")}))}),[]);return r.a.createElement("div",null,r.a.createElement("h3",null,"Map ",l),r.a.createElement(ee.a,null,r.a.createElement(te.a,null,r.a.createElement(ne.a,{xs:12},r.a.createElement("div",null,function(){var e,t=[],a=Object(d.a)(n);try{var o=function(){var n=e.value,a=n.coords.split(",").map((function(e){return parseInt(e)})),o=Object(ue.a)(a),i=o[0],c=o[1],s=(o.slice(2),{position:"absolute",top:"".concat(c-15,"px"),left:"".concat(i-15,"px"),width:"30px",height:"30px"});t.push(r.a.createElement("img",{src:"images/map-dot-blurred.png",key:"".concat(n.id),className:"background-map-dot",style:s})),t.push(r.a.createElement("img",{src:"images/map-dot.png",key:"".concat(n.id,"hover"),className:"selected-map-dot",onMouseOver:function(e){return u(n.name)},onMouseOut:function(e){return u("")},onClick:function(){return h.push("/chat/".concat(n.id))},style:s}))};for(a.s();!(e=a.n()).done;)o()}catch(i){a.e(i)}finally{a.f()}return t}(),r.a.createElement("img",{src:"/images/map.jpg",alt:"map",className:"map-image"}))))))}function fe(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],o=t[1];Object(a.useEffect)((function(){var e=E.getState();void 0!==e&&void 0!==e.state&&o(!0)}),[]);var i=function(e){!function(e,t){e.dispatch({type:"LOAD_USER",payload:t})}(E,e),o(!0)},s=function(){O(E),function(){var e,t=document.cookie.split(";"),n=window.location.hostname.split("."),a=location.pathname.split("/"),r=Object(d.a)(t);try{var o=function(){var t=e.value;n.forEach((function(e,r,o){var i="".concat(encodeURIComponent(t.split(";")[0].split("=")[0]),"}").concat("=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain=").concat(v(n,r).join(".")).concat(" ;path=");document.cookie="".concat(i,"/"),a.forEach((function(e,t,n){document.cookie="".concat(i).concat(v(a,t).join("/"))}))}))};for(r.s();!(e=r.n()).done;)o()}catch(i){r.e(i)}finally{r.f()}}(),o(!1)};return r.a.createElement("div",null,r.a.createElement(_,{logged:n}),r.a.createElement(I.a,null,r.a.createElement(M.c,null,r.a.createElement(M.a,{exact:!0,path:"/",component:H}),r.a.createElement(M.a,{exact:!0,path:"/login",component:function(){return r.a.createElement(G,{onLogged:i})}}),r.a.createElement(M.a,{exact:!0,path:"/login/unauthorized",component:function(){return r.a.createElement(G,{isUnauthorized:!0,onLogged:i})}}),r.a.createElement(M.a,{exact:!0,path:"/logout",component:function(){return r.a.createElement(ie,{onLogout:s})}}),r.a.createElement(M.a,{exact:!0,path:"/registration",component:q}),r.a.createElement(M.a,{exact:!0,path:"/users",component:ce}),r.a.createElement(M.a,{exact:!0,path:"/characters",component:se}),r.a.createElement(M.a,{exact:!0,path:"/character/new",component:V}),r.a.createElement(M.a,{exact:!0,path:"/character/:id",component:le}),r.a.createElement(M.a,{exact:!0,path:"/chats",component:he}),r.a.createElement(M.a,{exact:!0,path:"/chat/:id",component:oe}))))}var de=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function me(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ve=document.getElementById("index-page");i.a.render(r.a.createElement(fe,null),ve),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");de?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):me(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):me(t,e)}))}}()}},[[81,1,2]]]);
//# sourceMappingURL=main.a96321b4.chunk.js.map